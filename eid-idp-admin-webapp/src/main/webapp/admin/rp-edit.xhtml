<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:s="http://jboss.com/products/seam/taglib">
<body>
<ui:composition template="/WEB-INF/template.xhtml">
    <ui:param name="activeMenu" value="rps"/>
    <ui:define name="body">

        <h2>Relying Party: #{selectedRP.name}</h2>

        <h:form>

            <rich:tabPanel switchType="client"
                           selectedTab="#{idpRP.selectedTab}">

                <rich:tab name="tab_config" label="Configuration">
                    <h:panelGrid columns="2" border="0">

                        <h:outputLabel for="name" value="Name"/>
                        <s:decorate>
                            <h:inputText id="name" value="#{selectedRP.name}"
                                         size="50"/>
                            <h:message for="name" styleClass="error"/>
                        </s:decorate>

                        <h:outputLabel for="domain" value="Domain"/>
                        <s:decorate>
                            <h:inputText id="domain"
                                         value="#{selectedRP.domain}"
                                         size="50"/>
                            <h:message for="domain" styleClass="error"/>
                        </s:decorate>

                        <h:outputLabel for="targetURL" value="Target URL"/>
                        <s:decorate>
                            <h:inputText id="targetURL"
                                         value="#{selectedRP.targetURL}"
                                         size="50"/>
                            <h:message for="targetURL" styleClass="error"/>
                        </s:decorate>

                    </h:panelGrid>
                </rich:tab>

                <rich:tab name="tab_pki" label="PKI">
                    <h:panelGrid columns="2" border="0">

                        <h:outputText
                                value="eID Trust Service Authentication Trust Domain:"/>
                        <h:inputText value="#{selectedRP.authnTrustDomain}"/>

                        <h:outputText
                                value="eID Trust Service Identification (National Registry) Trust Domain:"/>
                        <h:inputText value="#{selectedRP.identityTrustDomain}"/>

                    </h:panelGrid>
                </rich:tab>

                <rich:tab name="tab_secret" label="Secrets">
                    <h:panelGrid columns="2" border="0">

                        <h:outputText
                                value="HMAC-SHA1 Identifier Secret (hexadecimal)"/>
                        <h:inputText value="#{selectedRP.identifierSecretKey}"
                                     size="50"/>

                        <h:outputText value="Attribute Secret Algorithm"/>
                        <h:selectOneMenu
                                value="#{selectedRP.attributeSecretAlgorithm}">
                            <f:selectItems value="#{secretAlgorithms}"/>
                        </h:selectOneMenu>

                        <h:outputText
                                value="Attribute Secret (hexadecimal)"/>
                        <s:decorate>
                            <h:inputText
                                    value="#{selectedRP.attributeSymmetricSecretKey}"
                                    id="attr_secret_sym" size="50"/>
                            <h:message for="attr_secret_sym"
                                       styleClass="error"/>
                        </s:decorate>

                        <h:outputLabel for="upload_secret"
                                       value="Attribute Secret Private Key"/>
                        <rich:fileUpload
                                fileUploadListener="#{idpRP.uploadListenerSecret}"
                                id="upload_secret" immediateUpload="true">
                        </rich:fileUpload>
                        <h:message for="upload_secret"
                                   styleClass="error"/>

                    </h:panelGrid>

                    <p>
                        <rich:simpleTogglePanel switchType="client"
                                                opened="false"
                                                rendered="#{idpRP.attributeAssymetricSecret != null}"
                                                label="Attribute Secret Private Key">
                            <h:outputText styleClass="text block"
                                          value="#{idpRP.attributeAssymetricSecret}"/>
                        </rich:simpleTogglePanel>
                    </p>

                </rich:tab>

                <rich:tab name="tab_signing" label="Signing">
                    <h:panelGrid columns="2" border="0">

                        <h:outputText value="Requires request signing?"/>
                        <h:selectBooleanCheckbox
                                value="#{selectedRP.requestSigningRequired}"/>


                        <h:outputLabel value="Certificate Subject"/>
                        <h:outputLabel
                                value="#{selectedRP.certificateSubject}"/>

                        <h:outputLabel for="upload" value="Certificate"/>
                        <rich:fileUpload
                                fileUploadListener="#{idpRP.uploadListener}"
                                maxFilesQuantity="1" id="upload"
                                immediateUpload="true">
                        </rich:fileUpload>
                        <h:message for="upload"
                                   styleClass="error"/>

                    </h:panelGrid>

                    <p>
                        <rich:simpleTogglePanel switchType="client"
                                                opened="false"
                                                rendered="#{selectedRP.certificate != null}"
                                                label="Certificate">
                            <h:outputText id="cert_view" styleClass="text block"
                                          value="#{selectedRP.certificate}"/>
                        </rich:simpleTogglePanel>
                    </p>

                </rich:tab>

                <rich:tab name="tab_attributes" label="Attributes">
                    <h:panelGrid columns="2" border="0">

                        <h:outputLabel value="Attributes"/>
                        <rich:dataTable id="data" var="item"
                                        value="#{selectedRP.attributes}"
                                        rowClasses="listingTable_Row1,listingTable_Row2"
                                        rendered="#{selectedRP.attributes != null}">

                            <h:column>
                                <f:facet name="header">Attribute</f:facet>
                                <h:outputText value="#{item.attribute.uri}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">Encrypted?</f:facet>
                                <h:selectBooleanCheckbox
                                        value="#{item.encrypted}"/>
                            </h:column>

                        </rich:dataTable>
                    </h:panelGrid>

                </rich:tab>

            </rich:tabPanel>

            <h:panelGrid columns="3" border="0">

                <h:commandButton action="#{idpRP.save}" id="save"
                                 value="Save"/>
                <h:commandButton action="#{idpRP.selectAttributes}"
                                 id="select_attributes"
                                 value="Select Attributes"
                                 rendered="#{selectedRP.attributes != null}"/>
                <h:commandButton action="#{idpRP.back}" id="back"
                                 value="Back"
                                 immediate="true"/>
            </h:panelGrid>

            <h:messages globalOnly="true" styleClass="error"/>

        </h:form>


    </ui:define>
</ui:composition>
</body>
</html>
