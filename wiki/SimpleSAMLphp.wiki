#summary Integrate eid-idp in a php application with SimpleSAMLphp.

= Introduction =

This document describes how to enable eID authentication/identification through eid-idp in php application. [http://simpleSAMLphp.org SimpleSAMLphp] will be used for the SAML integration.


= Install SimpleSAMLphp =

Please refer to the SimpleSAMLphp documentation for installation instructions. We will consider the application as being installed on the default install location (/var/simplesamlphp), but other locations should work.

In the Apache httpd configuration, make sure an Alias is available to the www directory of the simplesamlphp distribution, as noted in the install documentation.

{{{
<VirtualHost *>
  #      ServerName service.example.com
        DocumentRoot /var/www/

        Alias /simplesaml /var/simplesamlphp/www
</VirtualHost>
}}}

= SimpleSAMLphp configuration =

First, edit */var/simplesamlphp/metatdata/saml20-idp-remote.php*:

{{{
<?php
$metadata['e-contract'] = array (
  'entityid' => 'e-contract',
  'metadata-set' => 'saml20-idp-remote',
  'SingleSignOnService' => 'https://www.e-contract.be/eid-idp/protocol/saml2/post/auth-ident',
  'certFingerprint' => 'd838f129659ef5d2f3ea974221e0d8ae1bb5206b',
  'OrganizationName' => 'e-Contract eID IDP',
  'OrganizationURL' => 'http://www.e-contract.be'
);
?>
}}}

*SingleSignOnService* and *certFingerprint* can be found on the eid-idp home page (e.g. https://www.e-contract.be/eid-idp/)

Edit */var/simplesamlphp/config/authsources.php*: edit the entity ID of the eID IDP you just configured in saml20-idp-remote.php as default IDP.

{{{
<?php

$config = array(

        // An authentication source which can authenticate against both SAML 2.0
        // and Shibboleth 1.3 IdPs.
        'default-sp' => array(
                'saml:SP',

                // The entity ID of the IdP this should SP should contact.
                // Can be NULL/unset, in which case the user will be shown a list of available IdPs.
                'idp' => 'e-contract',

        ),

);
}}}

= 